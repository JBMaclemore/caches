/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
jQuery(function(C){function j(e,o,t){if(e.find(".bbp-reply-form form").find("#bbp-template-notices").html(""),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media){e.find(".gif-media-search-dropdown").removeClass("open"),e.find("#whats-new-toolbar .toolbar-button").removeClass("active disable");var i=e.find("#whats-new-attachments .forums-attached-gif-container");i.length&&(i.addClass("closed"),i.find(".gif-image-container img").attr("src",""),i[0].style=""),e.find("#bbp_media_gif").length&&e.find("#bbp_media_gif").val(""),void 0!==o&&t&&(void 0!==bp.Nouveau.Media.dropzone_obj[o]&&(bp.Nouveau.Media.dropzone_obj[o].destroy(),bp.Nouveau.Media.dropzone_obj.splice(o,1),bp.Nouveau.Media.dropzone_media.splice(o,1)),e.find('div#forums-post-media-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-media-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-document-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-document-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-video-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-video-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"))}}C("body").hasClass("reply-edit")||C(document).on("submit",".bbp-reply-form form",function(e){if(e.preventDefault(),C(this).hasClass("submitting"))return!1;C(this).addClass("submitting");var o=!0,t=!0,i=C(e.target).find(".bbp-the-content").data("key"),d=!1;void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[i]&&(d=window.forums_medium_reply_editor[i]),(0<C(this).find("#bbp_media").length&&0<C(this).find("#bbp_document").length&&0<C(this).find("#bbp_video").length&&0<C(this).find("#bbp_media_gif").length&&""==C(this).find("#bbp_media").val()&&""==C(this).find("#bbp_document").val()&&""==C(this).find("#bbp_video").val()&&""==C(this).find("#bbp_media_gif").val()||0<C(this).find("#bbp_media").length&&0<C(this).find("#bbp_document").length&&0<C(this).find("#bbp_video").length&&C(this).find("#bbp_media_gif").length<=0&&""==C(this).find("#bbp_media").val()&&""==C(this).find("#bbp_video").val()&&""==C(this).find("#bbp_document").val()||0<C(this).find("#bbp_media_gif").length&&C(this).find("#bbp_media").length<=0&&C(this).find("#bbp_document").length<=0&&C(this).find("#bbp_video").length<=0&&""==C(this).find("#bbp_media_gif").val())&&(t=!1),d&&""===C(C.parseHTML(C(this).find("#bbp_reply_content").val())).text().trim()&&0==t?(C(this).find(".bbp-the-content").addClass("error"),o=!1):d||""!==C.trim(C(this).find("#bbp_reply_content").val())||0!=t?(d&&C(this).find(".bbp-the-content").removeClass("error"),C(this).find("#bbp_reply_content").removeClass("error")):(C(this).find("#bbp_reply_content").addClass("error"),o=!1),o?function(e,o,t,i){var w={action:e,nonce:o};C.each(t,function(e,o){"action"===o.name?w.bbp_reply_form_action=o.value:w[o.name]=o.value});var g=i.closest("#bbpress-forums");C.post(window.bbpReplyAjaxJS.bbp_ajaxurl,w,function(o){if(o.success){g.find(".bbp-reply-form form").removeClass("submitting");var e="",t=C(".bb-quick-reply-form-wrap");if("edit"===o.reply_type)e='<li class="highlight">'+o.content+"</li>",C("#post-"+o.reply_id).parent("li").replaceWith(e);else{if(window.bbpReplyAjaxJS.threaded_reply&&o.reply_parent&&o.reply_parent!==o.reply_id){var i=null,d="1";if(C("#post-"+o.reply_parent).parent("li").data("depth")==window.bbpReplyAjaxJS.threaded_reply_depth){var r=parseInt(window.bbpReplyAjaxJS.threaded_reply_depth)-1;i=C("#post-"+o.reply_parent).closest("li.depth-"+r),d=window.bbpReplyAjaxJS.threaded_reply_depth}else i=C("#post-"+o.reply_parent).parent("li"),d=parseInt(i.data("depth"))+1;var a="ul";g.find(".bb-single-reply-list").is("ol")&&(a="ol"),i.find(">"+a+".bbp-threaded-replies").length||i.append("<"+a+' class="bbp-threaded-replies"></'+a+">"),e='<li class="highlight depth-'+d+'" data-depth="'+d+'">'+o.content+"</li>",i.find(">"+a+".bbp-threaded-replies").append(e)}else if(o.current_page==o.total_pages)e='<li class="highlight depth-1" data-depth="1">'+o.content+"</li>",g.find(".bb-single-reply-list").append(e);else{var n=o.redirect_url,p=n.substring(0,n.indexOf("#"));t.length||t.is(":visible")||(window.location.href=p)}jQuery(window).scroll()}if(""!==o.tags){var s=C("body .item-tags"),l=C("body .item-tags ul");"none"===s.css("display")?(s.append(o.tags),s.show()):(l.remove(),s.append(o.tags))}""!=e&&(C("body").animate({scrollTop:C(e).offset().top},500),setTimeout(function(){C(e).removeClass("highlight")},2e3));var b=g.find(".bbp-reply-form form").find("#forums-post-media-uploader").data("key"),m=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[b]&&bp.Nouveau.Media.dropzone_media[b].length){m=!0;for(var u=0;u<bp.Nouveau.Media.dropzone_media[b].length;u++)bp.Nouveau.Media.dropzone_media[b][u].saved=!0}var f=g.find(".bbp-reply-form form").find("#forums-post-document-uploader").data("key"),c=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[f]&&bp.Nouveau.Media.dropzone_media[f].length){c=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[f].length;u++)bp.Nouveau.Media.dropzone_media[f][u].saved=!0}var _=g.find(".bbp-reply-form form").find("#forums-post-video-uploader").data("key"),v=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[_]&&bp.Nouveau.Media.dropzone_media[_].length){v=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[_].length;u++)bp.Nouveau.Media.dropzone_media[_][u].saved=!0}var h=g.find(".bbp-reply-form form").find(".bbp-the-content").data("key");void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[h]&&window.forums_medium_reply_editor[h].resetContent(),g.find(".bbp-reply-form form").find(".bbp-the-content").removeClass("error"),t.length&&t.is(":visible")?g.find(".bbp-reply-form").hide():g.find("#bbp-close-btn").trigger("click"),g.find(".header-total-reply-count.bp-hide").removeClass("bp-hide"),o.total_reply_count&&(g.find(".header-total-reply-count .topic-reply-count").html(o.total_reply_count),g.find(".topic-lead .bs-replies").html(o.total_reply_count),C(".bs-forums-items").removeClass("topic-list-no-replies")),0<g.find(".replies-content .bp-feedback.info").length&&g.find(".replies-content .bp-feedback.info").remove(),g.find("#bbp_reply_content").val(""),j(g,b,m),j(g,f,c),j(g,_,v);var y=g.find(".scrubberpost");y.length&&y.each(function(e){var t,i;if(C(this).hasClass("post-"+o.reply_id))return C(".scrubber").each(function(e,o){if(i=C(o).data("key"),void 0!==window.BuddyBossThemeBbpScrubber.scrubbers[i])return t=window.BuddyBossThemeBbpScrubber.scrubbers[i],!1}),t.total_item=parseInt(t.total_item,10)+1,t.to=parseInt(t.to,10)+1,window.BuddyBossThemeBbpScrubber.goToPost(parseInt(e,10)+1,"",i),!1})}else void 0!==o.content&&g.find(".bbp-reply-form form").find("#bbp-template-notices").html(o.content);g.find(".bbp-reply-form form").removeClass("submitting"),C(".bbp-reply-form").trigger("bbp_after_submit_reply_form",{response:o,topic_id:w.bbp_topic_id})})}("reply",window.bbpReplyAjaxJS.reply_nonce,C(this).serializeArray(),C(this)):C(this).removeClass("submitting")});var l={init:function(){this.ajax_call(),this.moveToReply()},ajax_call:function(){C(document).on("click",'a[data-btn-id="bbp-reply-form"]',function(e){e.preventDefault();var o=C(this),t=o.closest("li"),r=o.data("topic-id"),a=t.find(".activity-discussion-title-wrap a").text(),i=t.data("bp-activity"),d=i.group_id?i.group_id:0;C(".bb-quick-reply-form-wrap").length&&C(".bb-quick-reply-form-wrap").remove(),C("body").addClass("bb-modal-overlay-open").append('<div class="bb-modal-overlay js-modal-close"></div>'),C(".bb-modal-overlay").fadeTo(0,1);var n=o.closest(".bb-grid .content-area"),p='<div id="bbpress-forums" class="bbpress-forums-activity bb-quick-reply-form-wrap"><div class="bbp-reply-form bb-modal bb-modal-box"><form id="new-post" name="new-post" method="post" action=""><fieldset class="bbp-form"><legend>'+window.bbpReplyAjaxJS.reply_to_text+' <span id="bbp-reply-exerpt"> '+a+'...</span><a href="#" id="bbp-close-btn" class="js-modal-close"><i class="bb-icon-close"></i></a></legend><div><div class="bbp-the-content-wrapper"><div class="bbp-the-content bbp_editor_reply_content medium-editor-element" contenteditable="true" data-placeholder="'+window.bbpReplyAjaxJS.type_reply_here_text+'"></div></div></fieldset></form></div></div>';n.append(p),n.find(".bb-quick-reply-form-wrap").show(0).find(".bbp-reply-form").addClass("bb-modal bb-modal-box").show(0),n.find(".bb-quick-reply-form-wrap .bbp-the-content-wrapper").addClass("loading").show(0);var s={action:"quick_reply_ajax",topic_id:r,group_id:d,"bbp-ajax":1};C.post(ajaxurl,s,function(e){if(n.append(e),n.find("div.bb-quick-reply-form-wrap").length){var o=n.find('div.bb-quick-reply-form-wrap[data-component="activity"');if(o.show(),o.not('[data-component="activity"]').hide(),o.find(".bbp-reply-form").length&&(o.find(".bbp-reply-form").addClass("bb-modal bb-modal-box"),o.find(".bbp-reply-form").show(),o.find(".bbp-reply-form").find("#bbp-reply-exerpt").text(a+"..."),o.find(".bbp-reply-form").find("#bbp_topic_id").val(r),l.addSelect2(o),l.addEditor(o),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media)){if(void 0!==bp.Nouveau.Media.options){var t=o.find(".bbp-reply-form").find(".forum-post-media-template").length?o.find(".bbp-reply-form").find(".forum-post-media-template")[0].innerHTML:"";bp.Nouveau.Media.options.previewTemplate=t}if(void 0!==bp.Nouveau.Media.documentOptions){var i=o.find(".bbp-reply-form").find(".forum-post-document-template").length?o.find(".bbp-reply-form").find(".forum-post-document-template")[0].innerHTML:"";bp.Nouveau.Media.documentOptions.previewTemplate=i}if(void 0!==bp.Nouveau.Media.videoOptions){var d=o.find(".bbp-reply-form").find(".forum-post-video-template").length?o.find(".bbp-reply-form").find(".forum-post-video-template")[0].innerHTML:"";bp.Nouveau.Media.videoOptions.previewTemplate=d}}o.find(".bbp-no-reply").length&&(o.find(".bbp-no-reply").addClass("bb-modal bb-modal-box"),o.find(".bbp-no-reply").show())}})})},addSelect2:function(e){var o=e.find(".bbp_topic_tags_dropdown"),d=[];o.length&&(o.select2({placeholder:o.attr("placeholder"),dropdownParent:o.closest("form").parent(),minimumInputLength:1,closeOnSelect:!0,tags:!0,language:"undefined"!=typeof bp_select2&&void 0!==bp_select2.lang?bp_select2.lang:"en",dropdownCssClass:"bb-select-dropdown bb-tag-list-dropdown",containerCssClass:"bb-select-container",tokenSeparators:[","," "],ajax:{url:bbpCommonJsData.ajax_url,dataType:"json",delay:1e3,data:function(e){return C.extend({},e,{_wpnonce:bbpCommonJsData.nonce,action:"search_tags"})},cache:!0,processResults:function(i){return!1===C.isEmptyObject(d)&&C.each(d,function(e,o){for(var t=0;t<i.data.results.length;t++)i.data.results[t].id===o&&i.data.results.splice(t,1)}),{results:i&&i.success?i.data.results:[]}}}}),o.on("select2:select",function(e){var o=e.params.data;d.push(o.id);var t=d.join(",");C("body #bbp_topic_tags").val(t),C("body .select2-search__field").trigger("click"),C("body .select2-search__field").trigger("click")}),o.on("select2:unselect",function(e){var o=e.params.data,t=(d=C.grep(d,function(e){return e!==o.id})).join(",");C("body #bbp_topic_tags").val(t),0===t.length&&C(window).scrollTop(C(window).scrollTop()+1)}))},addEditor:function(o){if(void 0!==window.MediumEditor){var t={buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor","pre"],relativeContainer:o.find("#whats-new-toolbar")[0],static:!0,updateOnEmptySelection:!0};o.find(".bbp_editor_reply_content").length&&(window.forums_medium_reply_editor=[],o.find(".bbp_editor_reply_content").each(function(e,d){var r=C(d).data("key");window.forums_medium_reply_editor[r]=new window.MediumEditor(d,{placeholder:{text:window.bbpEditorJsStrs.type_reply,hideOnClick:!0},toolbar:t,paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav"],unwrapTags:["ul","ol","li"]},imageDragging:!1,anchor:{linkValidation:!0}}),window.forums_medium_reply_editor[r].subscribe("editableInput",function(){var e=C(d).closest("form").find("#bbp_reply_content"),o=window.forums_medium_reply_editor[r].getContent(),t=document.createElement("div");t.innerHTML=o,C(t).find("span.atwho-query").replaceWith(function(){return this.innerText}),C(t).find("img.emoji").each(function(e,o){C(o).addClass("emojioneemoji");var t=C(o).attr("alt");C(o).attr("data-emoji-char",t),C(o).removeClass("emoji")}),C(t).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),e.val(C(t).html());var i=jQuery(d).html();i=(i=jQuery.trim(i.replace(/<div>/gi,"\n").replace(/<\/div>/gi,""))).replace(/&nbsp;/g," "),""!==jQuery(i).text()||0<=i.indexOf("emojioneemoji")?jQuery(d).closest("form").addClass("has-content"):jQuery(d).closest("form").removeClass("has-content")}),o.on("click","#whats-new-toolbar .show-toolbar",function(e){e.preventDefault();var o=C(e.currentTarget).closest(".bbp-reply-form").find(".bbp_editor_reply_content").data("key"),t=C(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");C(e.currentTarget).find(".toolbar-button").toggleClass("active"),C(e.currentTarget).find(".toolbar-button").hasClass("active")?(C(e.currentTarget).attr("data-bp-tooltip",C(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.forums_medium_reply_editor[o].exportSelection()&&t.addClass("medium-editor-toolbar-active")):(C(e.currentTarget).attr("data-bp-tooltip",C(e.currentTarget).attr("data-bp-tooltip-show")),null===window.forums_medium_reply_editor[o].exportSelection()&&t.removeClass("medium-editor-toolbar-active")),C(window.forums_medium_reply_editor[o].elements[0]).focus(),t.toggleClass("active")})}))}"undefined"!=typeof BP_Nouveau&&void 0!==BP_Nouveau.media&&void 0!==BP_Nouveau.media.emoji&&o.find(".bbp-the-content").length&&void 0!==C.prototype.emojioneArea&&o.find(".bbp-the-content").each(function(e,o){var t=C(o).attr("id"),i=C(o).data("key");C("#"+t).emojioneArea({standalone:!0,hideSource:!1,container:C("#"+t).closest("form").find("#whats-new-toolbar > .post-emoji"),autocomplete:!1,pickerPosition:"bottom",hidePickerOnBlur:!0,useInternalCDN:!1,events:{ready:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[i]&&window.forums_medium_topic_editor[i].resetContent(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[i]&&window.forums_medium_reply_editor[i].resetContent(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[i]&&window.forums_medium_forum_editor[i].resetContent()},emojibtn_click:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[i]&&window.forums_medium_topic_editor[i].checkContentChanged(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[i]&&window.forums_medium_reply_editor[i].checkContentChanged(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[i]&&window.forums_medium_forum_editor[i].checkContentChanged(),void 0===window.forums_medium_topic_editor&&C("#"+t).keyup(),C("#"+t)[0].emojioneArea.hidePicker()},search_keypress:function(){var e=this.search.val().toLowerCase();this.search.val(e)}}})}),void 0===window.forums_medium_reply_editor&&jQuery("#bbp_reply_content").on("keyup",function(){""!==jQuery("#bbp_reply_content").val().trim()?jQuery(this).closest("form").addClass("has-content"):jQuery(this).closest("form").removeClass("has-content")})},moveToReply:function(){if(0<window.location.href.indexOf("#post-")){var e=window.location.href.split("#post-"),o=e&&void 0!==e[1]?e[1]:"";if(!o||0==C("#post-"+o).length)return;var t,i=0;0<C("#wpadminbar").length&&(i=C("#wpadminbar").innerHeight()),t=C("body").hasClass("sticky-header")?C("#post-"+o).parent().offset().top-C("#masthead").innerHeight()-i:C("#post-"+o).parent().offset().top-i,C("html, body").animate({scrollTop:t},200)}}};l.init()});